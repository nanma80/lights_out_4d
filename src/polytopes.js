// polytopes.js â€” 4D polytope data definitions

export const POLYTOPE_16CELL = {
  name: "16-cell",
  vertices: [
    [1, 0, 0, 0],  // 0: +X
    [-1, 0, 0, 0], // 1: -X
    [0, 1, 0, 0],  // 2: +Y
    [0, -1, 0, 0], // 3: -Y
    [0, 0, 1, 0],  // 4: +Z
    [0, 0, -1, 0], // 5: -Z
    [0, 0, 0, 1],  // 6: +W
    [0, 0, 0, -1], // 7: -W
  ],
  rings: [
    { vertices: [0, 2, 1, 3], bundle: 0 },  // XY plane
    { vertices: [0, 4, 1, 5], bundle: 1 },  // XZ plane
    { vertices: [0, 6, 1, 7], bundle: 2 },  // XW plane
    { vertices: [2, 4, 3, 5], bundle: 3 },  // YZ plane
    { vertices: [2, 6, 3, 7], bundle: 4 },  // YW plane
    { vertices: [4, 6, 5, 7], bundle: 5 },  // ZW plane
  ],
  bundleColors: [
    "#ff3366", // ring 0
    "#33ff66", // ring 1
    "#3366ff", // ring 2
    "#ffcc00", // ring 3
    "#ff6633", // ring 4
    "#cc33ff", // ring 5
  ],
  cellCenter: [0.5, 0.5, 0.5, 0.5],
};

export const POLYTOPE_24CELL = {
  name: "24-cell",
  vertices: [
    [0.7071067812, 0.7071067812, 0.0000000000, 0.0000000000],  // 0
    [0.7071067812, -0.7071067812, 0.0000000000, 0.0000000000],  // 1
    [-0.7071067812, 0.7071067812, 0.0000000000, 0.0000000000],  // 2
    [-0.7071067812, -0.7071067812, 0.0000000000, 0.0000000000],  // 3
    [0.7071067812, 0.0000000000, 0.7071067812, 0.0000000000],  // 4
    [0.7071067812, 0.0000000000, -0.7071067812, 0.0000000000],  // 5
    [-0.7071067812, 0.0000000000, 0.7071067812, 0.0000000000],  // 6
    [-0.7071067812, 0.0000000000, -0.7071067812, 0.0000000000],  // 7
    [0.7071067812, 0.0000000000, 0.0000000000, 0.7071067812],  // 8
    [0.7071067812, 0.0000000000, 0.0000000000, -0.7071067812],  // 9
    [-0.7071067812, 0.0000000000, 0.0000000000, 0.7071067812],  // 10
    [-0.7071067812, 0.0000000000, 0.0000000000, -0.7071067812],  // 11
    [0.0000000000, 0.7071067812, 0.7071067812, 0.0000000000],  // 12
    [0.0000000000, 0.7071067812, -0.7071067812, 0.0000000000],  // 13
    [0.0000000000, -0.7071067812, 0.7071067812, 0.0000000000],  // 14
    [0.0000000000, -0.7071067812, -0.7071067812, 0.0000000000],  // 15
    [0.0000000000, 0.7071067812, 0.0000000000, 0.7071067812],  // 16
    [0.0000000000, 0.7071067812, 0.0000000000, -0.7071067812],  // 17
    [0.0000000000, -0.7071067812, 0.0000000000, 0.7071067812],  // 18
    [0.0000000000, -0.7071067812, 0.0000000000, -0.7071067812],  // 19
    [0.0000000000, 0.0000000000, 0.7071067812, 0.7071067812],  // 20
    [0.0000000000, 0.0000000000, 0.7071067812, -0.7071067812],  // 21
    [0.0000000000, 0.0000000000, -0.7071067812, 0.7071067812],  // 22
    [0.0000000000, 0.0000000000, -0.7071067812, -0.7071067812],  // 23
  ],
  rings: [
    { vertices: [16, 20, 14, 19, 23, 13], bundle: 0 },
    { vertices: [4, 9, 23, 7, 10, 20], bundle: 1 },
    { vertices: [0, 5, 15, 3, 6, 12], bundle: 0 },
    { vertices: [17, 21, 14, 18, 22, 13], bundle: 2 },
    { vertices: [8, 18, 3, 11, 17, 0], bundle: 1 },
    { vertices: [9, 17, 2, 10, 18, 1], bundle: 0 },
    { vertices: [2, 11, 19, 1, 8, 16], bundle: 3 },
    { vertices: [11, 23, 5, 8, 20, 6], bundle: 2 },
    { vertices: [1, 15, 7, 2, 12, 4], bundle: 2 },
    { vertices: [15, 23, 17, 12, 20, 18], bundle: 3 },
    { vertices: [16, 22, 15, 19, 21, 12], bundle: 1 },
    { vertices: [9, 19, 3, 10, 16, 0], bundle: 2 },
    { vertices: [9, 21, 6, 10, 22, 5], bundle: 3 },
    { vertices: [1, 5, 13, 2, 6, 14], bundle: 1 },
    { vertices: [3, 14, 4, 0, 13, 7], bundle: 3 },
    { vertices: [8, 22, 7, 11, 21, 4], bundle: 0 },
  ],
  bundleColors: ["#ff3366", "#33ff66", "#3366ff", "#ffcc00"],
  cellCenter: [0.5, 0.5, 0.5, 0.5],
};

export const POLYTOPE_600CELL = {
  name: "600-cell",
  vertices: [
    [1.0000000000, 0.0000000000, 0.0000000000, 0.0000000000],  // 0
    [-1.0000000000, 0.0000000000, 0.0000000000, 0.0000000000],  // 1
    [0.0000000000, 1.0000000000, 0.0000000000, 0.0000000000],  // 2
    [0.0000000000, -1.0000000000, 0.0000000000, 0.0000000000],  // 3
    [0.0000000000, 0.0000000000, 1.0000000000, 0.0000000000],  // 4
    [0.0000000000, 0.0000000000, -1.0000000000, 0.0000000000],  // 5
    [0.0000000000, 0.0000000000, 0.0000000000, 1.0000000000],  // 6
    [0.0000000000, 0.0000000000, 0.0000000000, -1.0000000000],  // 7
    [0.5000000000, 0.5000000000, 0.5000000000, 0.5000000000],  // 8
    [0.5000000000, 0.5000000000, 0.5000000000, -0.5000000000],  // 9
    [0.5000000000, 0.5000000000, -0.5000000000, 0.5000000000],  // 10
    [0.5000000000, 0.5000000000, -0.5000000000, -0.5000000000],  // 11
    [0.5000000000, -0.5000000000, 0.5000000000, 0.5000000000],  // 12
    [0.5000000000, -0.5000000000, 0.5000000000, -0.5000000000],  // 13
    [0.5000000000, -0.5000000000, -0.5000000000, 0.5000000000],  // 14
    [0.5000000000, -0.5000000000, -0.5000000000, -0.5000000000],  // 15
    [-0.5000000000, 0.5000000000, 0.5000000000, 0.5000000000],  // 16
    [-0.5000000000, 0.5000000000, 0.5000000000, -0.5000000000],  // 17
    [-0.5000000000, 0.5000000000, -0.5000000000, 0.5000000000],  // 18
    [-0.5000000000, 0.5000000000, -0.5000000000, -0.5000000000],  // 19
    [-0.5000000000, -0.5000000000, 0.5000000000, 0.5000000000],  // 20
    [-0.5000000000, -0.5000000000, 0.5000000000, -0.5000000000],  // 21
    [-0.5000000000, -0.5000000000, -0.5000000000, 0.5000000000],  // 22
    [-0.5000000000, -0.5000000000, -0.5000000000, -0.5000000000],  // 23
    [0.8090169944, 0.5000000000, 0.3090169944, 0.0000000000],  // 24
    [0.8090169944, 0.5000000000, -0.3090169944, 0.0000000000],  // 25
    [0.8090169944, -0.5000000000, 0.3090169944, 0.0000000000],  // 26
    [0.8090169944, -0.5000000000, -0.3090169944, 0.0000000000],  // 27
    [-0.8090169944, 0.5000000000, 0.3090169944, 0.0000000000],  // 28
    [-0.8090169944, 0.5000000000, -0.3090169944, 0.0000000000],  // 29
    [-0.8090169944, -0.5000000000, 0.3090169944, 0.0000000000],  // 30
    [-0.8090169944, -0.5000000000, -0.3090169944, 0.0000000000],  // 31
    [0.8090169944, 0.3090169944, 0.0000000000, 0.5000000000],  // 32
    [0.8090169944, -0.3090169944, 0.0000000000, 0.5000000000],  // 33
    [0.8090169944, 0.3090169944, 0.0000000000, -0.5000000000],  // 34
    [0.8090169944, -0.3090169944, 0.0000000000, -0.5000000000],  // 35
    [-0.8090169944, 0.3090169944, 0.0000000000, 0.5000000000],  // 36
    [-0.8090169944, -0.3090169944, 0.0000000000, 0.5000000000],  // 37
    [-0.8090169944, 0.3090169944, 0.0000000000, -0.5000000000],  // 38
    [-0.8090169944, -0.3090169944, 0.0000000000, -0.5000000000],  // 39
    [0.8090169944, 0.0000000000, 0.5000000000, 0.3090169944],  // 40
    [0.8090169944, 0.0000000000, 0.5000000000, -0.3090169944],  // 41
    [0.8090169944, 0.0000000000, -0.5000000000, 0.3090169944],  // 42
    [0.8090169944, 0.0000000000, -0.5000000000, -0.3090169944],  // 43
    [-0.8090169944, 0.0000000000, 0.5000000000, 0.3090169944],  // 44
    [-0.8090169944, 0.0000000000, 0.5000000000, -0.3090169944],  // 45
    [-0.8090169944, 0.0000000000, -0.5000000000, 0.3090169944],  // 46
    [-0.8090169944, 0.0000000000, -0.5000000000, -0.3090169944],  // 47
    [0.5000000000, 0.8090169944, 0.0000000000, 0.3090169944],  // 48
    [0.5000000000, 0.8090169944, 0.0000000000, -0.3090169944],  // 49
    [-0.5000000000, 0.8090169944, 0.0000000000, 0.3090169944],  // 50
    [-0.5000000000, 0.8090169944, 0.0000000000, -0.3090169944],  // 51
    [0.5000000000, -0.8090169944, 0.0000000000, 0.3090169944],  // 52
    [0.5000000000, -0.8090169944, 0.0000000000, -0.3090169944],  // 53
    [-0.5000000000, -0.8090169944, 0.0000000000, 0.3090169944],  // 54
    [-0.5000000000, -0.8090169944, 0.0000000000, -0.3090169944],  // 55
    [0.5000000000, 0.3090169944, 0.8090169944, 0.0000000000],  // 56
    [0.5000000000, -0.3090169944, 0.8090169944, 0.0000000000],  // 57
    [-0.5000000000, 0.3090169944, 0.8090169944, 0.0000000000],  // 58
    [-0.5000000000, -0.3090169944, 0.8090169944, 0.0000000000],  // 59
    [0.5000000000, 0.3090169944, -0.8090169944, 0.0000000000],  // 60
    [0.5000000000, -0.3090169944, -0.8090169944, 0.0000000000],  // 61
    [-0.5000000000, 0.3090169944, -0.8090169944, 0.0000000000],  // 62
    [-0.5000000000, -0.3090169944, -0.8090169944, 0.0000000000],  // 63
    [0.5000000000, 0.0000000000, 0.3090169944, 0.8090169944],  // 64
    [0.5000000000, 0.0000000000, -0.3090169944, 0.8090169944],  // 65
    [-0.5000000000, 0.0000000000, 0.3090169944, 0.8090169944],  // 66
    [-0.5000000000, 0.0000000000, -0.3090169944, 0.8090169944],  // 67
    [0.5000000000, 0.0000000000, 0.3090169944, -0.8090169944],  // 68
    [0.5000000000, 0.0000000000, -0.3090169944, -0.8090169944],  // 69
    [-0.5000000000, 0.0000000000, 0.3090169944, -0.8090169944],  // 70
    [-0.5000000000, 0.0000000000, -0.3090169944, -0.8090169944],  // 71
    [0.3090169944, 0.8090169944, 0.5000000000, 0.0000000000],  // 72
    [-0.3090169944, 0.8090169944, 0.5000000000, 0.0000000000],  // 73
    [0.3090169944, 0.8090169944, -0.5000000000, 0.0000000000],  // 74
    [-0.3090169944, 0.8090169944, -0.5000000000, 0.0000000000],  // 75
    [0.3090169944, -0.8090169944, 0.5000000000, 0.0000000000],  // 76
    [-0.3090169944, -0.8090169944, 0.5000000000, 0.0000000000],  // 77
    [0.3090169944, -0.8090169944, -0.5000000000, 0.0000000000],  // 78
    [-0.3090169944, -0.8090169944, -0.5000000000, 0.0000000000],  // 79
    [0.3090169944, 0.5000000000, 0.0000000000, 0.8090169944],  // 80
    [-0.3090169944, 0.5000000000, 0.0000000000, 0.8090169944],  // 81
    [0.3090169944, -0.5000000000, 0.0000000000, 0.8090169944],  // 82
    [-0.3090169944, -0.5000000000, 0.0000000000, 0.8090169944],  // 83
    [0.3090169944, 0.5000000000, 0.0000000000, -0.8090169944],  // 84
    [-0.3090169944, 0.5000000000, 0.0000000000, -0.8090169944],  // 85
    [0.3090169944, -0.5000000000, 0.0000000000, -0.8090169944],  // 86
    [-0.3090169944, -0.5000000000, 0.0000000000, -0.8090169944],  // 87
    [0.3090169944, 0.0000000000, 0.8090169944, 0.5000000000],  // 88
    [-0.3090169944, 0.0000000000, 0.8090169944, 0.5000000000],  // 89
    [0.3090169944, 0.0000000000, 0.8090169944, -0.5000000000],  // 90
    [-0.3090169944, 0.0000000000, 0.8090169944, -0.5000000000],  // 91
    [0.3090169944, 0.0000000000, -0.8090169944, 0.5000000000],  // 92
    [-0.3090169944, 0.0000000000, -0.8090169944, 0.5000000000],  // 93
    [0.3090169944, 0.0000000000, -0.8090169944, -0.5000000000],  // 94
    [-0.3090169944, 0.0000000000, -0.8090169944, -0.5000000000],  // 95
    [0.0000000000, 0.8090169944, 0.3090169944, 0.5000000000],  // 96
    [0.0000000000, 0.8090169944, -0.3090169944, 0.5000000000],  // 97
    [0.0000000000, 0.8090169944, 0.3090169944, -0.5000000000],  // 98
    [0.0000000000, 0.8090169944, -0.3090169944, -0.5000000000],  // 99
    [0.0000000000, -0.8090169944, 0.3090169944, 0.5000000000],  // 100
    [0.0000000000, -0.8090169944, -0.3090169944, 0.5000000000],  // 101
    [0.0000000000, -0.8090169944, 0.3090169944, -0.5000000000],  // 102
    [0.0000000000, -0.8090169944, -0.3090169944, -0.5000000000],  // 103
    [0.0000000000, 0.5000000000, 0.8090169944, 0.3090169944],  // 104
    [0.0000000000, 0.5000000000, 0.8090169944, -0.3090169944],  // 105
    [0.0000000000, -0.5000000000, 0.8090169944, 0.3090169944],  // 106
    [0.0000000000, -0.5000000000, 0.8090169944, -0.3090169944],  // 107
    [0.0000000000, 0.5000000000, -0.8090169944, 0.3090169944],  // 108
    [0.0000000000, 0.5000000000, -0.8090169944, -0.3090169944],  // 109
    [0.0000000000, -0.5000000000, -0.8090169944, 0.3090169944],  // 110
    [0.0000000000, -0.5000000000, -0.8090169944, -0.3090169944],  // 111
    [0.0000000000, 0.3090169944, 0.5000000000, 0.8090169944],  // 112
    [0.0000000000, -0.3090169944, 0.5000000000, 0.8090169944],  // 113
    [0.0000000000, 0.3090169944, -0.5000000000, 0.8090169944],  // 114
    [0.0000000000, -0.3090169944, -0.5000000000, 0.8090169944],  // 115
    [0.0000000000, 0.3090169944, 0.5000000000, -0.8090169944],  // 116
    [0.0000000000, -0.3090169944, 0.5000000000, -0.8090169944],  // 117
    [0.0000000000, 0.3090169944, -0.5000000000, -0.8090169944],  // 118
    [0.0000000000, -0.3090169944, -0.5000000000, -0.8090169944],  // 119
  ],
  rings: [
    { vertices: [96, 104, 4, 107, 102, 103, 111, 5, 108, 97], bundle: 0 },
    { vertices: [47, 62, 108, 10, 32, 40, 57, 107, 21, 39], bundle: 1 },
    { vertices: [17, 58, 89, 113, 82, 14, 61, 94, 118, 85], bundle: 0 },
    { vertices: [28, 58, 4, 57, 26, 27, 61, 5, 62, 29], bundle: 2 },
    { vertices: [47, 71, 7, 68, 41, 40, 64, 6, 67, 46], bundle: 0 },
    { vertices: [76, 107, 91, 17, 51, 75, 108, 92, 14, 52], bundle: 2 },
    { vertices: [99, 109, 5, 110, 101, 100, 106, 4, 105, 98], bundle: 1 },
    { vertices: [99, 118, 119, 103, 3, 100, 113, 112, 96, 2], bundle: 3 },
    { vertices: [9, 72, 96, 81, 67, 22, 79, 103, 86, 68], bundle: 2 },
    { vertices: [29, 50, 96, 8, 40, 26, 53, 103, 23, 47], bundle: 4 },
    { vertices: [5, 92, 65, 64, 88, 4, 91, 70, 71, 95], bundle: 3 },
    { vertices: [9, 90, 107, 77, 54, 22, 93, 108, 74, 49], bundle: 5 },
    { vertices: [21, 55, 79, 110, 92, 10, 48, 72, 105, 91], bundle: 0 },
    { vertices: [6, 66, 44, 45, 70, 7, 69, 43, 42, 65], bundle: 2 },
    { vertices: [58, 104, 8, 32, 42, 61, 111, 23, 39, 45], bundle: 3 },
    { vertices: [111, 119, 7, 116, 105, 104, 112, 6, 115, 110], bundle: 5 },
    { vertices: [92, 115, 83, 20, 59, 91, 116, 84, 11, 60], bundle: 4 },
    { vertices: [25, 34, 68, 117, 21, 30, 37, 67, 114, 10], bundle: 3 },
    { vertices: [8, 112, 66, 37, 31, 23, 119, 69, 34, 24], bundle: 1 },
    { vertices: [25, 43, 15, 103, 55, 30, 44, 16, 96, 48], bundle: 1 },
    { vertices: [54, 79, 111, 94, 11, 49, 72, 104, 89, 20], bundle: 1 },
    { vertices: [2, 50, 36, 37, 54, 3, 53, 35, 34, 49], bundle: 0 },
    { vertices: [43, 60, 108, 18, 36, 44, 59, 107, 13, 35], bundle: 3 },
    { vertices: [22, 37, 44, 58, 105, 9, 34, 43, 61, 110], bundle: 4 },
    { vertices: [51, 73, 104, 88, 12, 52, 78, 111, 95, 19], bundle: 4 },
    { vertices: [74, 75, 29, 1, 30, 77, 76, 26, 0, 25], bundle: 0 },
    { vertices: [14, 33, 40, 56, 105, 17, 38, 47, 63, 110], bundle: 3 },
    { vertices: [12, 100, 54, 31, 47, 19, 99, 49, 24, 40], bundle: 2 },
    { vertices: [22, 46, 29, 51, 98, 9, 41, 26, 52, 101], bundle: 3 },
    { vertices: [20, 113, 64, 32, 25, 11, 118, 71, 39, 30], bundle: 2 },
    { vertices: [14, 42, 25, 49, 98, 17, 45, 30, 54, 101], bundle: 4 },
    { vertices: [106, 107, 117, 7, 118, 109, 108, 114, 6, 113], bundle: 4 },
    { vertices: [66, 89, 4, 90, 68, 69, 94, 5, 93, 67], bundle: 4 },
    { vertices: [36, 66, 113, 12, 26, 35, 69, 118, 19, 29], bundle: 5 },
    { vertices: [5, 60, 25, 24, 56, 4, 59, 30, 31, 63], bundle: 5 },
    { vertices: [76, 102, 87, 71, 19, 75, 97, 80, 64, 12], bundle: 1 },
    { vertices: [88, 113, 83, 22, 63, 95, 118, 84, 9, 56], bundle: 1 },
    { vertices: [48, 49, 84, 7, 87, 55, 54, 83, 6, 80], bundle: 3 },
    { vertices: [68, 116, 17, 28, 36, 67, 115, 14, 27, 35], bundle: 1 },
    { vertices: [80, 81, 36, 1, 39, 87, 86, 35, 0, 32], bundle: 4 },
    { vertices: [15, 119, 71, 38, 28, 16, 112, 64, 33, 27], bundle: 4 },
    { vertices: [21, 59, 89, 112, 80, 10, 60, 94, 119, 87], bundle: 2 },
    { vertices: [33, 42, 60, 109, 19, 38, 45, 59, 106, 12], bundle: 0 },
    { vertices: [73, 96, 80, 65, 14, 78, 103, 87, 70, 17], bundle: 5 },
    { vertices: [23, 95, 109, 74, 48, 8, 88, 106, 77, 55], bundle: 2 },
    { vertices: [114, 115, 101, 3, 102, 117, 116, 98, 2, 97], bundle: 2 },
    { vertices: [46, 93, 92, 42, 0, 41, 90, 91, 45, 1], bundle: 1 },
    { vertices: [76, 106, 89, 16, 50, 75, 109, 94, 15, 53], bundle: 3 },
    { vertices: [65, 115, 22, 31, 39, 70, 116, 9, 24, 32], bundle: 0 },
    { vertices: [21, 45, 28, 50, 97, 10, 42, 27, 53, 102], bundle: 5 },
    { vertices: [50, 81, 6, 82, 52, 53, 86, 7, 85, 51], bundle: 1 },
    { vertices: [57, 88, 112, 81, 18, 62, 95, 119, 86, 13], bundle: 0 },
    { vertices: [57, 106, 20, 37, 46, 62, 109, 11, 34, 41], bundle: 5 },
    { vertices: [18, 114, 65, 33, 26, 13, 117, 70, 38, 29], bundle: 1 },
    { vertices: [83, 100, 76, 13, 68, 84, 99, 75, 18, 67], bundle: 5 },
    { vertices: [13, 41, 24, 48, 97, 18, 46, 31, 55, 102], bundle: 4 },
    { vertices: [35, 41, 56, 104, 16, 36, 46, 63, 111, 15], bundle: 2 },
    { vertices: [16, 73, 98, 84, 69, 15, 78, 101, 83, 66], bundle: 0 },
    { vertices: [88, 89, 44, 1, 47, 95, 94, 43, 0, 40], bundle: 5 },
    { vertices: [15, 86, 117, 91, 58, 16, 81, 114, 92, 61], bundle: 5 },
    { vertices: [27, 78, 79, 31, 1, 28, 73, 72, 24, 0], bundle: 3 },
    { vertices: [90, 116, 85, 19, 62, 93, 115, 82, 12, 57], bundle: 3 },
    { vertices: [62, 63, 79, 3, 76, 57, 56, 72, 2, 75], bundle: 4 },
    { vertices: [20, 66, 81, 97, 74, 11, 69, 86, 102, 77], bundle: 3 },
    { vertices: [23, 71, 85, 98, 72, 8, 64, 82, 101, 79], bundle: 5 },
    { vertices: [65, 82, 100, 77, 21, 70, 85, 99, 74, 10], bundle: 4 },
    { vertices: [1, 38, 85, 84, 34, 0, 33, 82, 83, 37], bundle: 2 },
    { vertices: [56, 90, 117, 87, 23, 63, 93, 114, 80, 8], bundle: 0 },
    { vertices: [38, 51, 2, 48, 32, 33, 52, 3, 55, 39], bundle: 5 },
    { vertices: [60, 74, 2, 73, 58, 59, 77, 3, 78, 61], bundle: 1 },
    { vertices: [90, 105, 73, 50, 18, 93, 110, 78, 53, 13], bundle: 2 },
    { vertices: [51, 99, 11, 43, 27, 52, 100, 20, 44, 28], bundle: 0 },
  ],
  bundleColors: ["#ff3366", "#33ff66", "#3366ff", "#ffcc00", "#ff6633", "#cc33ff"],
  cellCenter: [0.9256147934, 0.0, 0.1350453784, 0.3535533906],
};

// Build vertex-to-rings mapping: for each vertex, which ring indices contain it
export function buildVertexToRings(polytope) {
  const map = new Array(polytope.vertices.length).fill(null).map(() => []);
  polytope.rings.forEach((ring, ringIdx) => {
    ring.vertices.forEach(vIdx => {
      map[vIdx].push(ringIdx);
    });
  });
  return map;
}
